BOISSLyoNCg0KTmFtZTogRW1pbCBMeWtrZSBHcmFubg0KRW1haWw6IGVncmFubjIzQHN0dWRlbnQuYWF1LmRrDQpFZHVjYXRpb246IFNvZnR3YXJlIChTVykNCkFzc2lnbm1lbnQ6IEVrc2FtZW5zIG9wZ2F2ZSAxDQpEZXNjcmlwdGlvbjoNCkNhbGN1bGF0ZXIgd2l0aCBkaWZmZXJlbnQgb3B0aW9uLiBCb3RoIHRha2luZyB1bmFyeSBhbmQgYmluYXJ5IG9wZXJhdG9ycy4NClRoZSBjYWxjdWxhdGVyIGlzIHBlcmZvbWluZyB0aGUgYWN0aW9uIHRoZSB0aGUgYWNjdW11bGF0b3IuDQpUaGUgZmluYWwgYWNjdW11bGF0b3IgaXMgcHJpbnRlZCB3aGVuIHRoZSB1c2VyIGV4aXRzIHRoZSBwcm9ncmFtIHdpdGggJ3EnLg0KDQoqLw0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCiNpbmNsdWRlIDxtYXRoLmg + DQoNCnZvaWQgc2Nhbl9kYXRhKGNoYXIgKm9wZXJhdG9yLCBkb3VibGUgKiBvcGVyYW5kLCBpbnQgKmlzVW5hcnkpOw0Kdm9pZCBkb19uZXh0X29wKGNoYXIgKm9wZXJhdG9yLCBkb3VibGUgKiBvcGVyYW5kLCBkb3VibGUgKmFjY3VtdWxhdG9yLCBpbnQgKmlzVW5hcnkpOw0Kdm9pZCBydW5fY2FsY3VsYXRvcihkb3VibGUgKmFjY3VtdWxhdG9yKTsNCnZvaWQgcHJpbnRfaGVscCgpOw0KDQppbnQgbWFpbih2b2lkKQ0Kew0KICAgIGRvdWJsZSBhY2N1bXVsYXRvciA9IDAuMDsNCiAgICBydW5fY2FsY3VsYXRvcigmYWNjdW11bGF0b3IpOw0KDQogICAgcHJpbnRmKCJGaW5hbCByZXN1bHQgaXM6ICVsZlxuIiwgYWNjdW11bGF0b3IpOw0KDQogICAgcmV0dXJuIDA7DQp9DQoNCnZvaWQgcnVuX2NhbGN1bGF0b3IoZG91YmxlICphY2N1bXVsYXRvcikNCnsNCiAgICBjaGFyIG9wZXJhdG9yOw0KICAgIGRvdWJsZSBvcGVyYW5kOw0KICAgIGludCBpc1VuYXJ5ID0gMDsNCg0KICAgIHdoaWxlIChvcGVyYXRvciE9ICdxJykNCiAgICB7DQogICAgICAgIHNjYW5fZGF0YSgmb3BlcmF0b3IsICYgb3BlcmFuZCwgJmlzVW5hcnkpOw0KICAgICAgICBkb19uZXh0X29wKCZvcGVyYXRvciwgJiBvcGVyYW5kLCBhY2N1bXVsYXRvciwgJmlzVW5hcnkpOw0KICAgICAgICBwcmludGYoIlJlc3VsdCBzbyBmYXI6ICVsZlxuIiwgKmFjY3VtdWxhdG9yKTsNCiAgICAgICAgaXNVbmFyeSA9IDA7DQogICAgfQ0KfQ0KDQp2b2lkIHNjYW5fZGF0YShjaGFyICpvcGVyYXRvciwgZG91YmxlICogb3BlcmFuZCwgaW50ICppc1VuYXJ5KQ0Kew0KICAgIHByaW50ZigiRW50ZXIgb3BlcmF0b3IgKCdoJyBmb3IgaGVscCk6ICIpOw0KICAgIHNjYW5mKCIgJWMiLCBvcGVyYXRvcik7DQogICAgaWYgKCpvcGVyYXRvcj09ICdoJykNCiAgICB7DQogICAgICAgIHByaW50X2hlbHAoKTsNCiAgICB9DQogICAgZWxzZSBpZiAoKm9wZXJhdG9yPT0gJyMnIHx8ICogb3BlcmF0b3I9PSAnIScgfHwgKiBvcGVyYXRvcj09ICclJyB8fCAqIG9wZXJhdG9yPT0gJ3EnKQ0KICAgIHsNCiAgICAgICAgKmlzVW5hcnkgPSAxOw0KICAgICAgICAqb3BlcmFuZCA9IDAuMDsNCiAgICB9DQogICAgZWxzZSBpZiAoKm9wZXJhdG9yPT0gJysnIHx8ICogb3BlcmF0b3I9PSAnLScgfHwgKiBvcGVyYXRvcj09ICcqJyB8fCAqIG9wZXJhdG9yPT0gJy8nIHx8ICogb3BlcmF0b3I9PSAnXicpDQogICAgew0KICAgICAgICBwcmludGYoIkVudGVyIG9wZXJhbmQ6ICIpOw0KICAgICAgICBzY2FuZigiICVsZiIsIG9wZXJhbmQpOw0KICAgIH0NCiAgICBlbHNlDQogICAgew0KICAgICAgICBwcmludGYoIklucHV0IHdhcyBub3QgYW4gb3B0aW9uLCB2aWV3ICdoJyBmb3IgaGVscC5cbiIpOw0KICAgICAgICBwcmludGYoIlRyeSBhZ2Fpbi5cbiIpOw0KICAgICAgICBzY2FuX2RhdGEob3BlcmF0b3IsIG9wZXJhbmQsIGlzVW5hcnkpOw0KICAgIH0NCn0NCg0Kdm9pZCBkb19uZXh0X29wKGNoYXIgKm9wZXJhdG9yLCBkb3VibGUgKiBvcGVyYW5kLCBkb3VibGUgKmFjY3VtdWxhdG9yLCBpbnQgKmlzVW5hcnkpDQp7DQogICAgaWYgKCppc1VuYXJ5KQ0KICAgIHsNCiAgICAgICAgc3dpdGNoICgqb3BlcmF0b3IpDQogICAgICAgIHsNCiAgICAgICAgY2FzZSAnIyc6DQogICAgICAgICAgICAqYWNjdW11bGF0b3IgPSAqYWNjdW11bGF0b3IgPCAwID8gKmFjY3VtdWxhdG9yIDogc3FydCgqYWNjdW11bGF0b3IpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJyUnOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yICo9IC0xOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJyEnOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yID0gKmFjY3VtdWxhdG9yID09IDAgPyAqYWNjdW11bGF0b3IgOiAxIC8gKCphY2N1bXVsYXRvcik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICAgIHN3aXRjaCAoKm9wZXJhdG9yKQ0KICAgICAgICB7DQogICAgICAgIGNhc2UgJysnOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yICs9ICpvcGVyYW5kOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJy0nOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yIC09ICpvcGVyYW5kOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJyonOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yICo9ICpvcGVyYW5kOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJy8nOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yIC89ICpvcGVyYW5kOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ14nOg0KICAgICAgICAgICAgKmFjY3VtdWxhdG9yID0gcG93KCphY2N1bXVsYXRvciwgKm9wZXJhbmQpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0Kdm9pZCBwcmludF9oZWxwKCkNCnsNCiAgICBwcmludGYoIlxuQmluYXJ5IG9wZXJhdG9ycyB0byB1c2U6XG4iKTsNCiAgICBwcmludGYoIisgICAgZm9yIGFkZGl0aW9uIG9mIHRoZSBhY2N1bXVsYXRvciB3aXRoIHRoZSBvcGVyYW5kIGZvclxuIik7DQogICAgcHJpbnRmKCItICAgIGZvciBzdWJ0cmFjdGlvbiBvZiB0aGUgYWNjdW11bGF0b3Igd2l0aCB0aGUgb3BlcmFuZFxuIik7DQogICAgcHJpbnRmKCIqICAgIGZvciBtdWx0aXBsaWNhdGlvbiBvZiB0aGUgYWNjdW11bGF0b3Igd2l0aCB0aGUgb3BlcmFuZFxuIik7DQogICAgcHJpbnRmKCIvICAgIGZvciBkaXZpc2lvbiBvZiB0aGUgYWNjdW11bGF0b3IgYnkgdGhlIG9wZXJhbmRcbiIpOw0KICAgIHByaW50ZigiXiAgICBmb3IgcmFpc2luZyB0aGUgYWNjdW11bGF0b3IgdG8gdGhlIHBvd2VyIG9mIHRoZSBvcGVyYW5kXG4iKTsNCiAgICBwcmludGYoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4iKTsNCiAgICBwcmludGYoIlVuYXJ5IG9wZXJhdG9ycyB0byB1c2U6XG4iKTsNCiAgICBwcmludGYoIiMgICAgZm9yIHRoZSBzcXVhcmUgcm9vdCBvZiB0aGUgYWNjdW11bGF0b3JcbiIpOw0KICAgIHByaW50ZigiJSUgICB0byBjaGFuZ2UgdGhlIHNpZ24gb2YgdGhlIGFjY3VtdWxhdG9yXG4iKTsNCiAgICBwcmludGYoIiEgICAgdG8gZGl2aWRlIDEgYnkgdGhlIGFjY3VtdWxhdG9yXG4iKTsNCiAgICBwcmludGYoInEgICAgdG8gcXVpdCB0aGUgY2FsY3VsYXRvciB3aXRoIHRoZSBmaW5hbCByZXN1bHRcbiIpOw0KICAgIHByaW50ZigiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIik7DQp9